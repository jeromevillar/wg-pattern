syntax = "proto3";

package roleInfo;

import "msg_common.proto";

// 角色信息相关
enum c_cmd {
    lv_info_req = 0;
    lv_info_resp = 1;
    lv_config_req = 3;
    lv_config_resp = 4;
    lv_notice_resp = 5;
    // set_nick_req = 6;
    // set_nick_resp = 7;
    battery_skin_req = 8;
    battery_skin_resp = 9;
    props_invalid_resp = 10;
}

service msg_role_info_service {
    // 等级信息
    rpc lv_info (lv_info_req) returns (lv_info_resp);
    // 等级配置
    rpc lv_configs (lv_config_req) returns (lv_config_resp);
    // 等级通知
    rpc lv_notice (undefined) returns (lv_notice_resp);
    // 设置昵称(暂未开放)
    // rpc set_nick (set_nick_req) returns (set_nick_resp);
    // 炮台皮肤
    rpc battery_skin (battery_skin_req) returns (battery_skin_resp);
    // 道具失效
    rpc props_invalid (undefined) returns (props_invalid_resp);
}

enum info_op_code {
    success = 0;        // 成功
    fail = 1;           // 失败
    out_of_cash = 2;    // 金币不足
    same_nick = 3;      // 昵称一样
}

// 等级信息
message lv_info_req {
}

message lv_info_resp {
    uint32 lv = 1;                 // 当前等级
    uint64 exp = 2;                // 当前等级经验值
    uint64 need_exp = 3;           // 总经验值
    uint32 reward_lv = 4;          // 已领取奖励等级
    uint64 next_reward = 5;        // 下一可领取奖励(0表示没有下一奖励)
    uint64 total_reward = 6;       // 已领取总奖励
    uint32 fund_id = 7;            // 已购买基金id
    uint32 next_reward_lv = 8;     // 已领取等级下一可领取等级
    uint64 reward = 9;             // 已领取等级下一可领取奖励(0表示没有下一奖励)
    optional uint64 total_exp = 10;         // 累计总经验值
    // repeated lv_reward_info history = 11;    // 领奖记录 (请求平台数据)
}

// 等级配置
message lv_config_req {
    uint32 fund_id = 1;        // 基金id
}

message lv_config_resp {
    uint32 buy_mark = 1;       // 是否已购买(0未购买1当前已购买2旧已购买)
    uint64 price = 2;          // 基金价格
    repeated lv_config configs = 3;     // 等级配置列表
    optional uint32 fund_id = 4;        // 基金id
}

message lv_config {
    uint32 lv = 1;             // 等级(默认从1开始)
    uint64 exp = 2;            // 提升到下一等级需要的总经验
    uint64 award = 3;          // 对应基金可领取奖励
}

// 等级通知(房间通知)
message lv_notice_resp {
    uint32 old_lv = 1;         // 旧等级
    uint32 new_lv = 2;         // 提升到新等级
    uint64 uid = 3;            // 角色id
}

// 设置昵称(暂未开放)
//message set_nick_req {
//    string nick = 1;         // 修改的昵称
//}

//message set_nick_resp {
//    info_op_code code = 1;   // 操作结果
//    string nick = 2;         // 新昵称
//}

// 可使用的炮台皮肤 请求
message battery_skin_req {
}

// 可使用的炮台皮肤 返回/推送
message battery_skin_resp {
    repeated battery_skin_info skins = 1; // 皮肤列表
}

message battery_skin_info {
    int32 id = 1; // 炮台皮肤id
    string name = 2; // 皮肤名称
    uint32 valid_time = 3; // 有效时长 0无限 其它（秒）
    uint32 dead_time = 4; // 失效时间戳(秒)
    uint32 state = 5; // 状态 0空闲 1使用中
}

// 道具失效推送
message props_invalid_resp {
    repeated uint32 id = 1; // 道具id
}
